(this.webpackJsonpdibgram=this.webpackJsonpdibgram||[]).push([[0],{36:function(e,t,n){},37:function(e,t,n){"use strict";n.r(t);var a=n(1),s=n.n(a),i=n(15),r=n.n(i),c=n(10),o=n(2),u=n.n(o),l=n(7),d=n(12),h=n(3),p=n(4),j=n(6),b=n(5),O=n(9),v=n(8),f=n(18),g=n(20),m=n.n(g);Array.prototype.remove=function(e){for(var t=0;t<this.length;t++)this[t]===e&&this.splice(t,1)};Array.prototype.remove;var y=Object(f.a)("tdClient"),x=Object(f.a)("updateHandlers"),C=function(){function e(){Object(h.a)(this,e)}return Object(p.a)(e,null,[{key:"initializeTdLib",value:function(){var t=Object(l.a)(u.a.mark((function t(){var n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={use_test_dc:!1,log:{log_updates:!1,log_queries:!1}}.log,Object(v.a)(e,y)[y]=new m.a({useDatabase:!0,onUpdate:function(t){n.log_updates&&console.log("Update: ",t),Object(v.a)(e,x)[x][t["@type"]]&&Object(v.a)(e,x)[x][t["@type"]].forEach((function(e){return e(t)}))}}),t.next=4,e.sendQuery({"@type":"getAuthorizationState"});case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"registerUpdateHandler",value:function(t,n){void 0===Object(v.a)(e,x)[x][t]&&(Object(v.a)(e,x)[x][t]=[]),Object(v.a)(e,x)[x][t].push(n)}},{key:"unRegisterUpdateHandler",value:function(t,n){void 0!==Object(v.a)(e,x)[x][t]&&Object(v.a)(e,x)[x].remove(n)}},{key:"sendQuery",value:function(t){return{use_test_dc:!1,log:{log_updates:!1,log_queries:!1}}.log.log_queries&&console.log("Query: ",t),Object(v.a)(e,y)[y].send(t)}}]),e}();Object.defineProperty(C,y,{writable:!0,value:void 0}),Object.defineProperty(C,x,{writable:!0,value:{}}),C.registerUpdateHandler("updateAuthorizationState",(function(e){var t={api_id:3022678,api_hash:"d7b7676a82906a6182f4a5e5e9555673"},n=e.authorization_state;"authorizationStateWaitEncryptionKey"===n["@type"]&&C.sendQuery({"@type":"checkDatabaseEncryptionKey",encryption_key:""}),"authorizationStateWaitTdlibParameters"===n["@type"]&&C.sendQuery({"@type":"setTdlibParameters",parameters:{database_directory:"tdlib",use_message_database:!0,use_secret_chats:!0,api_id:t.api_id,api_hash:t.api_hash,system_language_code:"en",device_model:"Web",application_version:"0.0.1",enable_storage_optimizer:!0,use_test_dc:!1}})}));var S=function(){function e(){Object(h.a)(this,e)}return Object(p.a)(e,null,[{key:"givePhoneNumber",value:function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.sendQuery({"@type":"setAuthenticationPhoneNumber",phone_number:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"checkAuthCode",value:function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.sendQuery({"@type":"checkAuthenticationCode",code:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"check2FACode",value:function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.sendQuery({"@type":"checkAuthenticationPassword",password:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"registerNewAccount",value:function(){var e=Object(l.a)(u.a.mark((function e(t,n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.sendQuery({"@type":"registerUser",first_name:t,last_name:n});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}(),_=n(0);function w(e){return Object(_.jsx)("button",{className:"big-highlighted-button",onClick:e.onClick,children:e.children})}var N=n(21),k=(n(35),n(13)),E=n.n(k),A=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(){var e;Object(h.a)(this,n);for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];return(e=t.call.apply(t,[this].concat(s))).state={percentage:10},e}return Object(p.a)(n,[{key:"render",value:function(){return Object(_.jsx)("div",{className:"loading-spinner",children:Object(_.jsx)(N.a,Object(O.a)(Object(O.a)({percent:this.state.percentage,caps:"round",trackColor:"transparent",spin:"true"},this.props),{},{transitionDuration:"2000"}))})}},{key:"componentDidMount",value:function(){var e=this;this.intervalNum=setInterval((function(){e.setState({percentage:90-e.state.percentage})}),2e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.intervalNum)}}]),n}(s.a.Component);A.props={size:E.a.number.isRequired,lineWidth:E.a.number.isRequired,progressColor:E.a.string.isRequired};var D=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(){var e;Object(h.a)(this,n);for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];return(e=t.call.apply(t,[this].concat(s))).state={cState:"connectionStateReady"},e.handleUpdate=function(t){e.setState({cState:t.state["@type"]})},e}return Object(p.a)(n,[{key:"render",value:function(){return Object(_.jsx)("div",{className:"connectionState"+(["connectionStateConnecting","connectionStateConnectingToProxy","connectionStateWaitingForNetwork"].includes(this.state.cState)?"":" connected"),children:Object(_.jsx)(A,{progressColor:"rgb(168, 168, 168)",size:"20",lineWidth:"2"})})}},{key:"componentDidMount",value:function(){C.registerUpdateHandler("updateConnectionState",this.handleUpdate)}},{key:"componentWillUnmount",value:function(){C.registerUpdateHandler("updateConnectionState",this.handleUpdate)}}]),n}(s.a.Component),F=n(16),P=Object(F.a)((function(){var e=arguments.length>1?arguments[1]:void 0;if("REPLACE_CHAT_FILTERS"==e.type)return e.payload}),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());C.registerUpdateHandler("updateChatFilters",(function(e){e.chat_filters&&P.dispatch({type:"REPLACE_CHAT_FILTERS",payload:e.chat_filters})}));var T=P;function U(){return Object(_.jsxs)("button",{id:"hamburger-menu-button",children:[Object(_.jsx)("span",{}),Object(_.jsx)("span",{}),Object(_.jsx)("span",{})]})}function z(){return Object(_.jsx)("ul",{})}var L=Object(c.b)((function(e){return{useFolders:0!=(e||[]).length}}))((function(e){return e.useFolders?Object(_.jsxs)("div",{id:"navigation-menu",className:"uses-folders",children:[Object(_.jsxs)("div",{id:"chat-folders-list",children:[Object(_.jsx)(U,{}),Object(_.jsx)(z,{})]}),Object(_.jsx)("div",{id:"chat-list-container",children:Object(_.jsx)(D,{})})]}):Object(_.jsx)("div",{id:"navigation-menu"})}));function I(){return Object(_.jsx)(c.a,{store:T,children:Object(_.jsx)(L,{})})}function R(){return Object(_.jsxs)("div",{id:"messenger-screen",children:[Object(_.jsx)(I,{}),Object(_.jsxs)("div",{id:"chat-container",children:["This is messenger window. You've authenticated successfully!",Object(_.jsx)(w,{onClick:function(){C.sendQuery({"@type":"logOut"})},children:"Log out"})]})]})}var B=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(h.a)(this,n),(a=t.call(this,e)).handleFocus=function(){a.setState({inactive:!1,titleClass:a.getTitleClass(!0)})},a.handleBlur=function(){a.setState({inactive:!0,mouseX:"50%",titleClass:a.getTitleClass(!1)})},a.handleMouseDown=function(e){a.setState({mouseX:e.nativeEvent.offsetX+"px"})},a.handleKeyDown=function(e){"Enter"==e.key&&a.props.onEnterKeyPressed&&a.props.onEnterKeyPressed()},a.state={inactive:!1,mouseX:"50%",titleClass:a.getTitleClass(a.props.autoFocus)},a}return Object(p.a)(n,[{key:"getTitleClass",value:function(e){return e||this.props.value?"title top":"title placeholder"}},{key:"render",value:function(){var e=this,t="underlined-input";return this.state.inactive&&(t+=" inactive"),this.props.autoFocus&&(t+=" autoFocus"),this.props.invalid&&(t+=" invalid"),Object(_.jsxs)("div",{className:t,style:{"--mouse-left":this.state.mouseX||"50%"},children:[this.props.title?Object(_.jsx)("div",{className:this.state.titleClass,children:this.props.title}):null,Object(_.jsx)("input",{type:this.props.type,onChange:this.props.onChange,value:this.props.value,onMouseDown:this.handleMouseDown,onFocus:this.handleFocus,onBlur:this.handleBlur,autoFocus:this.props.autoFocus||!1,onKeyDown:this.handleKeyDown,maxLength:this.props.maxLength,onCopy:function(t){e.props.disableCopy&&t.preventDefault()}}),Object(_.jsx)("div",{className:"underline"})]})}}]),n}(s.a.Component),W=n(22),H=Object(F.a)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_DIALOG":return[].concat(Object(W.a)(e),[t.dialog]);case"REMOVE_DIALOG":return e.filter((function(e){return e.id!=t.id}))}}),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());function K(e){H.dispatch({type:"REMOVE_DIALOG",id:e})}function X(e){return e.children}var M=Object(c.b)((function(e){return{dialogs:e||[]}}))((function(e){return e.dialogs.map((function(e){return Object(_.jsx)(X,{children:e.element},e.id)}))||null}));function V(e){return Object(_.jsx)("button",Object(O.a)(Object(O.a)({className:"small-button"},e),{},{children:e.children}))}var Q=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(){var e;Object(h.a)(this,n);for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];return(e=t.call.apply(t,[this].concat(s))).state={closing:!1},e.handleOK=function(){e.closeDialog(),e.props.onOK&&e.props.onOK()},e.handleCancel=function(){e.closeDialog(),e.props.onCancel&&e.props.onCancel()},e.closeDialog=function(){e.setState({closing:!0}),setTimeout((function(){K(e.props.id)}),1e3)},e}return Object(p.a)(n,[{key:"render",value:function(){return Object(_.jsx)("div",{className:"modal-dialog confirm-dialog"+(this.state.closing?" closing":""),children:Object(_.jsxs)("div",{style:{width:this.props.width||"auto"},children:[Object(_.jsx)("h1",{children:this.props.title||""}),Object(_.jsx)("div",{className:"content",children:this.props.children}),Object(_.jsxs)("div",{className:"options",children:[this.props.hideCancelButton?null:Object(_.jsx)(V,{onClick:this.handleCancel,children:"Cancel"}),Object(_.jsx)(V,{onClick:this.handleOK,children:this.props.OKButtonText||"OK"})]})]})})}}]),n}(s.a.Component),q={"@type":void 0};function Y(e){q=e}function G(e){e.state=Object(O.a)(Object(O.a)({},e.state|{}),{},{statusContent:"",statusVisible:!1}),e.Status=function(){return Object(_.jsx)("div",{className:"status"+(e.state.statusVisible?"":" hidden"),children:e.state.statusContent})},e.changeStatus=function(t){t?e.setState({statusContent:t,statusVisible:!0}):(e.setState({statusVisible:!1}),setTimeout((function(){e.setState({statusContent:null})}),1e3))}}var J=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(){var e;Object(h.a)(this,n);for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];return(e=t.call.apply(t,[this].concat(s))).state={step:q},e.handleAuthStateUpdate=function(t){var n=t.authorization_state;["authorizationStateWaitPhoneNumber","authorizationStateWaitCode","authorizationStateWaitPassword","authorizationStateWaitRegistration","authorizationStateReady","authorizationStateClosed"].includes(n["@type"])&&e.setState({step:n})},e}return Object(p.a)(n,[{key:"componentDidMount",value:function(){var e=this;Y=function(t){e.setState({step:t})},C.registerUpdateHandler("updateAuthorizationState",this.handleAuthStateUpdate)}},{key:"render",value:function(){switch(this.state.step["@type"]){case"authorizationStateWaitPhoneNumber":return Object(_.jsx)(Z,{});case"authorizationStateWaitCode":return Object(_.jsx)($,{info:this.state.step.code_info});case"authorizationStateWaitPassword":return Object(_.jsx)(ee,{info:this.state.step});case"authorizationStateWaitRegistration":return Object(_.jsx)(te,{});case"authorizationStateReady":return Object(_.jsx)(R,{});case"authorizationStateClosed":return window.location.reload(),Object(_.jsx)("p",{children:"This session is closed. Please wait till DIBgram reloads automatically..."});default:return Object(_.jsx)("p",{children:"Loading..."})}}}]),n}(s.a.Component),Z=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(h.a)(this,n),(a=t.call(this,e)).state={number:"",invalid:!1},a.handlePNFieldChange=function(e){a.setState({number:e.target.value,invalid:!1}),a.changeStatus("")},a.submitNumber=Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:S.givePhoneNumber(a.state.number).catch((function(e){switch(e.message){case"PHONE_NUMBER_FLOOD":t="phone_number_flood_error",n=Object(_.jsxs)(Q,{width:"320px",hideCancelButton:!0,id:"phone_number_flood_error",children:["Sorry, you have deleted and re-created your account too many times recently.",Object(_.jsx)("br",{}),"Please wait for a few days before signing up again."]}),H.dispatch({type:"ADD_DIALOG",dialog:{element:n,id:t}}),a.changeStatus("");break;case"PHONE_NUMBER_INVALID":a.setState({invalid:!0}),a.changeStatus("Invalid phone number. Please try again.");break;case"Another authorization query has started":break;default:a.setState({invalid:!1}),a.changeStatus(e.message)}var t,n}));case 1:case"end":return e.stop()}}),e)}))),G(Object(d.a)(a)),a}return Object(p.a)(n,[{key:"render",value:function(){var e=this.Status;return Object(_.jsxs)("div",{id:"auth",className:"auth-step-phoneNumber",children:[Object(_.jsx)("h2",{children:"Your Phone Number"}),Object(_.jsx)("p",{className:"description",children:"Please confirm your country code and enter your mobile phone number."}),Object(_.jsx)(B,{type:"text",value:this.state.number,autoFocus:!0,onChange:this.handlePNFieldChange,onEnterKeyPressed:this.submitNumber,invalid:this.state.invalid}),Object(_.jsx)(e,{}),Object(_.jsx)(w,{onClick:this.submitNumber,children:"NEXT"}),Object(_.jsx)(D,{})]})}}]),n}(s.a.Component),$=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(h.a)(this,n),(a=t.call(this,e)).state={code:"",invalid:!1},a.handleCodeFieldChange=function(e){a.setState({code:e.target.value,invalid:!1}),a.changeStatus(""),e.target.value.length==a.props.info.type.length&&a.handleContinueButton(e.target.value)},a.handleContinueButton=function(e){"string"!=typeof e&&(e=void 0),(e=e||a.state.code).length==a.props.info.type.length&&S.checkAuthCode(e).catch((function(e){"PHONE_CODE_INVALID"===e.message?(a.setState({invalid:!0}),a.changeStatus("You have entered an invalid code.")):(a.setState({invalid:!0}),a.changeStatus(e.message))}))},G(Object(d.a)(a)),a}return Object(p.a)(n,[{key:"render",value:function(){var e=this.Status,t="authenticationCodeTypeSms"==this.props.info.type["@type"]?Object(_.jsxs)("p",{className:"description",children:["A code was sent ",Object(_.jsx)("strong",{children:"via SMS"})," to your phone number."]}):Object(_.jsxs)("p",{className:"description",children:["A code was sent ",Object(_.jsx)("strong",{children:"via Telegram"})," to your other devices, if you have any connected."]});return Object(_.jsxs)("div",{id:"auth",className:"auth-step-code",children:[Object(_.jsx)("h2",{children:this.props.info.phone_number}),t,Object(_.jsx)(B,{type:"text",value:this.state.code,onChange:this.handleCodeFieldChange,autoFocus:!0,title:"Code",maxLength:this.props.info.type.length,onEnterKeyPressed:this.handleContinueButton,invalid:this.state.invalid}),Object(_.jsx)(e,{}),Object(_.jsx)(w,{onClick:this.handleContinueButton,children:"NEXT"}),Object(_.jsx)(D,{})]})}}]),n}(s.a.Component),ee=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(h.a)(this,n),(a=t.call(this,e)).state={password:"",invalid:!1},a.handlePasswordFieldChange=function(e){a.setState({password:e.target.value,invalid:!1}),a.changeStatus("")},a.handleContinueButton=Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:S.check2FACode(a.state.password).catch((function(e){"PASSWORD_HASH_INVALID"==e.message?(a.setState({invalid:!0}),a.changeStatus("You have entered a wrong password.")):(a.setState({invalid:!0}),a.changeStatus(e.message))}));case 1:case"end":return e.stop()}}),e)}))),G(Object(d.a)(a)),a}return Object(p.a)(n,[{key:"render",value:function(){return Object(_.jsx)("div",{id:"auth",className:"auth-step-password",children:Object(_.jsxs)("div",{className:"content",children:[Object(_.jsx)("h2",{children:"Cloud password check"}),Object(_.jsx)("p",{className:"description",children:"Please enter your cloud password."}),Object(_.jsx)(B,{type:"text",value:this.state.password,onChange:this.handlePasswordFieldChange,autoFocus:!0,title:"Your cloud password",onEnterKeyPressed:this.handleContinueButton,disableCopy:!0,invalid:this.state.invalid}),Object(_.jsxs)("div",{className:"hint",children:["Hint: ",this.props.info.password_hint]}),Object(_.jsx)("div",{className:"forgot-password",children:Object(_.jsx)("a",{href:"#",children:"Forgot password?"})}),Object(_.jsx)("div",{className:"status",children:this.state.textUnderField||Object(_.jsx)("i",{children:"\xa0"})}),Object(_.jsx)(w,{onClick:this.handleContinueButton,children:"SUBMIT"}),Object(_.jsx)(D,{})]})})}}]),n}(s.a.Component),te=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(){var e;Object(h.a)(this,n);for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];return(e=t.call.apply(t,[this].concat(s))).state={firstName:"",lastName:""},e.handleFirstNameFieldChange=function(t){e.setState({firstName:t.target.value})},e.handleLastNameFieldChange=function(t){e.setState({lastName:t.target.value})},e.handleContinueButton=Object(l.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,S.registerNewAccount(e.state.firstName,e.state.lastName).catch((function(t){e.setState({textUnderField:t.message})}));case 2:case"end":return t.stop()}}),t)}))),e}return Object(p.a)(n,[{key:"render",value:function(){return Object(_.jsx)("div",{id:"auth",className:"auth-step-signup",children:Object(_.jsxs)("div",{className:"content",children:[Object(_.jsx)("h2",{children:"Your info"}),Object(_.jsx)("p",{className:"description",children:"Please enter your name and upload a photo."}),Object(_.jsx)(B,{type:"text",value:this.state.firstName,onChange:this.handleFirstNameFieldChange,autoFocus:!0}),Object(_.jsx)(B,{type:"text",value:this.state.lastName,onChange:this.handleLastNameFieldChange}),Object(_.jsx)("div",{className:"status",children:this.state.textUnderField||""}),Object(_.jsx)(w,{onClick:this.handleContinueButton,children:"SIGN UP"}),Object(_.jsx)(D,{})]})})}}]),n}(s.a.Component);n(36);C.initializeTdLib().then((function(e){Y(e)}));var ne=function(){return Object(_.jsxs)("div",{"data-theme":"classic",id:"app",children:[Object(_.jsx)(c.a,{store:H,children:Object(_.jsx)(M,{})}),Object(_.jsx)(J,{})]})};r.a.render(Object(_.jsx)(s.a.StrictMode,{children:Object(_.jsx)(ne,{})}),document.getElementById("root"))}},[[37,1,2]]]);
//# sourceMappingURL=main.e8904d7a.chunk.js.map